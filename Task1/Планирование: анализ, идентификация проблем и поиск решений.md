# Анализ, идентификация проблем и решений, планирование

[[__TOC__]]

## Проблемные места

### Существующие

1. Появились просроченные заказы
2. Пользователи API жалуются, что не получили свои заказы
3. Операторы жалуются, что страница со списком заказов долго загружается
4. Задержки релиза
5. Тестирование только ручное

### Потенциальные

1. Загрузка файлов происходит посредством API, что может существенно увеличить трафик идущий через них, а так же замедлить их работу
2. MES API выполняет слишком много функций и при этом никак не масштабируется
3. Shop API и CRM API используют одну базу данных
4. Состояние заказа модифицируется из множества мест, модификации никак не синхронизированны между собой

## Инициативы по улучшению ситуации (в порядке приоритета)

1. Выделить сервис Orders, который будет владеть всеми заказами и предоставлять API для их чтения и обновления. Этот сервис должен иметь собственную базу данных, недоступную всем остальным сервисам
2. Выделить из сервиса MES API новый сервис PriceCalculator, который будет заниматься исключительно подсчетом стоимости заказа. Данный сервис будет читать из очереди заказов изменения в статусе (если статус поменялся на SUBMITED) и публиковать стоимость заказа в другую очередь CALCULATED_PRICES. Данный сервис должен быть масштабирован
3. Файлы с 3д моделями изделий должны публиковаться в сторадж напрямую с компьютера пользователя, минуя API. Вместо этого API должен предоставлять метод для регистрации такой публикации.
4. В MES API необходимо добавить кэш заказов
5. Для MES при отображении списка заказов заменить pull модель на push (добавить веб сокеты)
6. Вынести функцию назначения заказа оператору в отдельный сервис operators, который будет владеть всеми данными об операторах
7. Добавить мониторинг, трейсинг и логирование во все сервисы

## Действия в случаях ограниченности времени

В случае, если есть время на выполнение только ограниченного списка задач, я бы предложил выполнить пункты 1, 2 и 3
